<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregate raster cells into larger cells or combine geometries of a vector — aggregate,GRaster-method • fasterRaster</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate raster cells into larger cells or combine geometries of a vector — aggregate,GRaster-method"><meta name="description" content='When applied to a GRaster, aggregate() creates a new raster with cells that are a multiple of the size of the cells of the original raster. The new cells can be larger or smaller than the original cells (this function thus emulates both the terra::aggregate() and terra::disagg() functions.)
When applied to a GVector, all geometries are combined into a "multipart" geometry, in which geometries are treated as if they were a single unit. Borders between aggregated geometries can be dissolved if the dissolve argument is TRUE. If the GVector has a data table associated with it, the output will also have a data table as long as there is at least one column with values that are all the same. Values of columns that do not have duplicated values will be converted to NA.'><meta property="og:description" content='When applied to a GRaster, aggregate() creates a new raster with cells that are a multiple of the size of the cells of the original raster. The new cells can be larger or smaller than the original cells (this function thus emulates both the terra::aggregate() and terra::disagg() functions.)
When applied to a GVector, all geometries are combined into a "multipart" geometry, in which geometries are treated as if they were a single unit. Borders between aggregated geometries can be dissolved if the dissolve argument is TRUE. If the GVector has a data table associated with it, the output will also have a data table as long as there is at least one column with values that are all the same. Values of columns that do not have duplicated values will be converted to NA.'><meta property="og:image" content="https://github.com/adamlilith/fasterRaster/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fasterRaster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">8.4.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/fasterRaster.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/GRasters.html">Types of GRasters</a></li>
    <li><a class="dropdown-item" href="../articles/faster_fasterRaster.html">Making fasterRaster faster</a></li>
    <li><a class="dropdown-item" href="../articles/addons.html">fasterRaster addons</a></li>
    <li><a class="dropdown-item" href="../articles/three_d_objects.html">3-dimensional objects</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/adamlilith/fasterRaster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Aggregate raster cells into larger cells or combine geometries of a vector</h1>
      <small class="dont-index">Source: <a href="https://github.com/adamlilith/fasterRaster/blob/master/R/aggregate.r"><code>R/aggregate.r</code></a></small>
      <div class="d-none name"><code>aggregate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When applied to a <code>GRaster</code>, <code>aggregate()</code> creates a new raster with cells that are a multiple of the size of the cells of the original raster. The new cells can be larger or smaller than the original cells (this function thus emulates both the <code><a href="https://rspatial.github.io/terra/reference/aggregate.html" class="external-link">terra::aggregate()</a></code> and <code><a href="https://rspatial.github.io/terra/reference/disaggregate.html" class="external-link">terra::disagg()</a></code> functions.)</p>
<p>When applied to a <code>GVector</code>, all geometries are combined into a "multipart" geometry, in which geometries are treated as if they were a single unit. Borders between aggregated geometries can be dissolved if the <code>dissolve</code> argument is <code>TRUE</code>. If the <code>GVector</code> has a data table associated with it, the output will also have a data table as long as there is at least one column with values that are all the same. Values of columns that do not have duplicated values will be converted to <code>NA</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'GRaster'</span></span>
<span><span class="fu">aggregate</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  fact <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  weight <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prob <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'GVector'</span></span>
<span><span class="fu">aggregate</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>GRaster</code> or <code>GVector</code>.</p></dd>


<dt id="arg-fact">fact<a class="anchor" aria-label="anchor" href="#arg-fact"></a></dt>
<dd><p>Numeric vector (rasters only): One, two, or three positive values. These reflect the size of the new cells as multiples of the size of the old cells. If just one value is supplied, this is used for all two or three dimensions. If two values are supplied, the first is multiplied by the east-west size of cells, and the second north-south size of cells (the raster must be 2D). If three values are supplied, the third value is used as the multiplier of the vertical dimension of cells. Values are calculated using all cells that have their centers contained by the target cell.</p>
<p>Note that unlike <code><a href="https://rspatial.github.io/terra/reference/aggregate.html" class="external-link">terra::aggregate()</a></code> and <code><a href="https://rspatial.github.io/terra/reference/disaggregate.html" class="external-link">terra::disagg()</a></code>, these values need not be integers.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>Character (rasters only): Name of the function used to aggregate. For <code>GRaster</code>s, this is the function that summarizes across cells. For <code>GVector</code>s, this function will be used to calculate new values of numeric or integer cells.</p><ul><li><p><code>mean</code>: Average (default)</p></li>
<li><p><code>median</code>: Median</p></li>
<li><p><code>mode</code>: Most common value</p></li>
<li><p><code>min</code>: Minimum</p></li>
<li><p><code>max</code>: Maximum</p></li>
<li><p><code>range</code>: Difference between maximum and minimum</p></li>
<li><p><code>sum</code>: Sum</p></li>
<li><p><code>varpop</code>: Population variance</p></li>
<li><p><code>sdpop</code>: Population standard deviation</p></li>
<li><p><code>quantile</code>: Quantile (see argument <code>prob</code>)</p></li>
<li><p><code>count</code>: Number of non-<code>NA</code> cell</p></li>
<li><p><code>diversity</code>: Number of unique values</p></li>
</ul></dd>


<dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>Logical (rasters only): If <code>FALSE</code>, each source cell that has its center in the destination cell will be counted equally. If <code>TRUE</code>, the value of each source will be weighted the proportion of the destination cell the source cell covers.</p></dd>


<dt id="arg-prob">prob<a class="anchor" aria-label="anchor" href="#arg-prob"></a></dt>
<dd><p>Numeric (rasters only): Quantile at which to calculate <code>quantile</code>.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Logical (rasters only): If <code>FALSE</code> (default), propagate <code>NA</code> cells or <code>NA</code> values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>GRaster</code> or <code>GVector</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">stats::aggregate()</a></code>, <code><a href="https://rspatial.github.io/terra/reference/aggregate.html" class="external-link">terra::aggregate()</a></code>, <code><a href="disagg.html">disagg()</a></code>, <code><a href="https://rspatial.github.io/terra/reference/disaggregate.html" class="external-link">terra::disagg()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="grassStarted.html">grassStarted</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setup</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example data</span></span></span>
<span class="r-in"><span><span class="va">madElev</span> <span class="op">&lt;-</span> <span class="fu"><a href="fastData.html">fastData</a></span><span class="op">(</span><span class="st">"madElev"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">madCoast4</span> <span class="op">&lt;-</span> <span class="fu"><a href="fastData.html">fastData</a></span><span class="op">(</span><span class="st">"madCoast4"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### aggregating a GRaster</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert:</span></span></span>
<span class="r-in"><span><span class="va">elev</span> <span class="op">&lt;-</span> <span class="fu"><a href="fast.html">fast</a></span><span class="op">(</span><span class="va">madElev</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Aggregate GRaster by same factor in 2 dimensions</span></span></span>
<span class="r-in"><span><span class="co"># fasterRaster</span></span></span>
<span class="r-in"><span><span class="va">agg2</span> <span class="op">&lt;-</span> <span class="fu">aggregate</span><span class="op">(</span><span class="va">elev</span>, <span class="fl">2</span>, <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">agg2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare rasters aggregated by fasterRaster and terra.</span></span></span>
<span class="r-in"><span><span class="co"># These should be the same.</span></span></span>
<span class="r-in"><span><span class="va">agg2terra</span> <span class="op">&lt;-</span> <span class="fu">aggregate</span><span class="op">(</span><span class="va">madElev</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">agg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="rast.html">rast</a></span><span class="op">(</span><span class="va">agg2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">agg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="extend.html">extend</a></span><span class="op">(</span><span class="va">agg2</span>, <span class="va">agg2terra</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">agg2</span> <span class="op">-</span> <span class="va">agg2terra</span> <span class="co"># value is ~0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Aggregate GRaster by a non-integer factor in 2 dimensions</span></span></span>
<span class="r-in"><span><span class="co"># fasterRaster</span></span></span>
<span class="r-in"><span><span class="va">agg2.9</span> <span class="op">&lt;-</span> <span class="fu">aggregate</span><span class="op">(</span><span class="va">elev</span>, <span class="fl">2.9</span>, <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">agg2.9</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># terra</span></span></span>
<span class="r-in"><span><span class="va">agg2.9terra</span> <span class="op">&lt;-</span> <span class="fu">aggregate</span><span class="op">(</span><span class="va">madElev</span>, <span class="fl">2.9</span>, <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">agg2.9terra</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare rasters aggregated by fasterRaster and terra.</span></span></span>
<span class="r-in"><span><span class="co"># These should be different.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="res.html">res</a></span><span class="op">(</span><span class="va">agg2.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="res.html">res</a></span><span class="op">(</span><span class="va">agg2.9terra</span><span class="op">)</span> <span class="co"># terra rounds aggregation factor down</span></span></span>
<span class="r-in"><span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="res.html">res</a></span><span class="op">(</span><span class="va">madElev</span><span class="op">)</span> <span class="co"># original resolution multiplied by 2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Aggregate GRaster by different factor in 2 dimensions</span></span></span>
<span class="r-in"><span><span class="va">agg2x3</span> <span class="op">&lt;-</span> <span class="fu">aggregate</span><span class="op">(</span><span class="va">elev</span>, <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">agg2x3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### aggregating a GVector</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">madCoast4</span> <span class="op">&lt;-</span> <span class="fu"><a href="fastData.html">fastData</a></span><span class="op">(</span><span class="st">"madCoast4"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert:</span></span></span>
<span class="r-in"><span><span class="va">coast4</span> <span class="op">&lt;-</span> <span class="fu"><a href="fast.html">fast</a></span><span class="op">(</span><span class="va">madCoast4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Aggregate and disaggregate:</span></span></span>
<span class="r-in"><span><span class="va">aggCoast</span> <span class="op">&lt;-</span> <span class="fu">aggregate</span><span class="op">(</span><span class="va">coast4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">disaggCoast</span> <span class="op">&lt;-</span> <span class="fu"><a href="disagg.html">disagg</a></span><span class="op">(</span><span class="va">coast4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="ngeom.html">ngeom</a></span><span class="op">(</span><span class="va">coast4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ngeom.html">ngeom</a></span><span class="op">(</span><span class="va">aggCoast</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ngeom.html">ngeom</a></span><span class="op">(</span><span class="va">disaggCoast</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot</span></span></span>
<span class="r-in"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">coast4</span>, main <span class="op">=</span> <span class="st">"Original"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="dim.html">nrow</a></span><span class="op">(</span><span class="va">coast4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">aggCoast</span>, main <span class="op">=</span> <span class="st">"Aggregated"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="dim.html">nrow</a></span><span class="op">(</span><span class="va">aggCoast</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">disaggCoast</span>, main <span class="op">=</span> <span class="st">"Disaggregated"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="dim.html">nrow</a></span><span class="op">(</span><span class="va">disaggCoast</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam B. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

